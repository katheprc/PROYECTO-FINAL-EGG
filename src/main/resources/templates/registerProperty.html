<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<link rel="stylesheet" type="text/css" href="/css/styles.css" />

		<!-- Fuentes -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link
			href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,200;0,400;0,500;0,600;0,700;0,900;1,400&family=Montserrat:wght@400;500;600;700;900&family=Rajdhani:wght@400;500;600;700&family=Roboto:wght@400;500;700;900&display=swap"
			rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&display=swap" rel="stylesheet">

		<title>registrar propiedad</title>
	</head>

	<body>
		<div className="barra">

			<div className="barra__contenido">
				<nav className="navegacion">

					<a th:if="${userType ne 'ADMIN' and userType ne 'OWNER' and userType ne 'CLIENT'}" href="/login"
						className="navegacion__micuenta"><button>Login</button></a>
					<a th:if="${userType ne 'ADMIN' and userType ne 'OWNER' and userType ne 'CLIENT'}" href="/register"
						className="navegacion__micuenta"><button>Registrarse</button></a>
					<a th:if="${userType eq 'ADMIN' or userType eq 'OWNER' or userType eq 'CLIENT'}" href="/profile"
						className="navegacion__micuenta"><button>Mi
							perfil</button></a>

					<a th:if="${userType eq 'OWNER'}" href="/register-property">
						<button>Registrar Propiedad</button>
					</a>
					<a th:if="${userType eq 'ADMIN' or userType eq 'OWNER' or userType eq 'CLIENT'}" href="/dashboard">
						<button>Dashboard</button>
					</a>
					<a th:if="${userType eq 'ADMIN' or userType eq 'OWNER' or userType eq 'CLIENT'}" href="/logout">
						<button>Logout</button>
					</a>
				</nav>
			</div>
		</div>
		<main class="auth">
			<h2 class="auth__heading">Portal de Registro de Propiedades</h2>
			<form method="post" action="/register-property" enctype="multipart/form-data">
				<div class="formulario__campo">
					<label for="propertyName">Nombre de la propiedad</label>
					<input type="text" id="propertyName" class="formulario__input" placeholder="Nombre"
						name="propertyName" required>
				</div>
				<div class="formulario__campo">
					<label for="propertyAddress">Calle y número</label>
					<input type="text" id="propertyAddress" class="formulario__input" placeholder="Ej: Solis 2988 "
						name="propertyAddress" required>
				</div>
				<div class="formulario__campo">
					<label for="propertyLocalidad">Localidad o Barrio</label>
					<input type="text" id="propertyLocalidad" class="formulario__input"
						placeholder="Ej: Avellaneda, Tigre ó Retiro" name="propertyLocalidad" required>
				</div>
				<div class="formulario__campo">
					<label for="propertyProvincia">Provincia</label>
					<input type="text" id="propertyProvincia" class="formulario__input"
						placeholder="Ej: Buenos Aires, Mendoza ó CABA" name="propertyProvincia" required>
				</div>
				<div class="formulario__campo">
					<label for="pricePerDay">Precio base por día</label>
					<input type="number" id="pricePerDay" class="formulario__input" placeholder="Pesos"
						name="pricePerDay" required>
				</div>
				<br>
				<div class="formulario__campo">
					<label for="imagenes">Selecciona imágenes:</label>
					<input type="file" name="imagenes" id="imagenes" accept="image/*" multiple>
					<br>
					<label for="details">Introduce detalles (máximo 255 caracteres): </label>

					<input type="text" id="details" class="formulario__input" placeholder="Descripción" name="details"
						maxlength="255">
				</div>
				<div id="inputContainer">
					<!-- Aquí se agregarán dinámicamente los inputs -->
				</div>
				<button type="button" onclick="agregarInput()">Agregar Servicios</button>
				<button type="button" onclick="eliminarUltimoInput()">Eliminar Último Servicio</button>
				<button type="submit">Enviar</button>
			</form>
		</main>
		<script>
			function agregarInput() {
				var inputContainer = document.getElementById('inputContainer');

				// Crear un nuevo objeto de entrada con nombre y precio
				var nuevoInput = document.createElement('div');
				nuevoInput.innerHTML = `
        <input type="text" name="nombre[]" placeholder="Nombre">
        <input type="number" name="precio[]" placeholder="Precio">
      `;

				inputContainer.appendChild(nuevoInput);
			}

			function eliminarUltimoInput() {
				var inputContainer = document.getElementById('inputContainer');
				var inputs = inputContainer.querySelectorAll('div');

				// Verificar si hay inputs antes de intentar eliminar
				if (inputs.length > 0) {
					inputContainer.removeChild(inputs[inputs.length - 1]);
				}
			}

			document.getElementById('dynamicForm').addEventListener('submit', function (event) {
				event.preventDefault(); // Evita que el formulario se envíe de forma convencional

				// Obtener los valores de los inputs
				var nombres = document.getElementsByName('nombre[]');
				var precios = document.getElementsByName('precio[]');

				var productos = [];

				// Crear objetos con nombre y precio
				for (var i = 0; i < nombres.length; i++) {
					var nombre = nombres[i].value;
					var precio = parseFloat(precios[i].value); // Convertir el precio a número
					productos.push({ nombre: nombre, precio: precio });
				}

				// Enviar los valores al endpoint (simulado aquí con un mensaje en la consola)
				console.log('Productos enviados al endpoint:', productos);
			});
		</script>

	</body>

</html>